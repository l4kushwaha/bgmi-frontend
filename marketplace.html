<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BGMI Marketplace</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
/* ================= ORIGINAL CSS (UNCHANGED) ================= */
body {
  margin:0;
  font-family:'Poppins',sans-serif;
  background: linear-gradient(135deg,#141e30,#243b55);
  color:#fff;
  overflow-x:hidden;
  transition: background 0.3s,color 0.3s;
}
body.dark{background: linear-gradient(135deg,#1a1a1a,#2c2c2c);color:#fff;}

#particle-canvas{position:fixed;inset:0;z-index:0;}

header{
  position:relative;
  z-index:2;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 20px;
  backdrop-filter:blur(12px);
  background: rgba(255,255,255,0.05);
  border-bottom: 1px solid rgba(255,255,255,0.1);
  border-radius:12px;
}
header h1{font-size:26px;font-weight:600;}
#controls{display:flex;gap:12px;align-items:center;}
#dark-toggle{
  padding:6px 10px;border:none;border-radius:10px;cursor:pointer;
  background:#3498db;color:#fff;transition:0.3s;
}
#dark-toggle:hover{background:#2980b9;}
#wallet-balance{
  font-size:14px;font-weight:600;
  background:rgba(255,255,255,0.1);
  padding:6px 12px;
  border-radius:12px;
}

/* ================= ADDITIONAL ANIMATION CSS ================= */
.item-card{
  will-change:transform,opacity;
  transform-style:preserve-3d;
  opacity:0;
  transform:translateY(40px) scale(.95);
  transition:transform .25s ease, box-shadow .25s ease, opacity .7s ease;
}

.item-card.show{
  opacity:1;
  transform:translateY(0) scale(1);
}

.item-card:hover{
  transform:translateY(-10px) scale(1.03);
  box-shadow:0 18px 40px rgba(0,0,0,.35);
}

/* Skeleton */
.skeleton{
  background:linear-gradient(90deg,#aaa,#ddd,#aaa);
  background-size:200%;
  animation:skeleton 1.2s infinite;
  border-radius:12px;
}
.skeleton.img{height:180px;margin-bottom:10px;}

@keyframes skeleton{
  from{background-position:200%}
  to{background-position:-200%}
}

@media(max-width:768px){
  .item-card:hover{transform:none}
}
</style>
</head>

<body>
<canvas id="particle-canvas"></canvas>

<header>
  <h1>BGMI Marketplace</h1>
  <div id="controls">
    <div id="wallet-balance">Wallet: â‚¹0</div>
    <button id="dark-toggle">Dark / Light</button>
  </div>
</header>

<div id="items-container">
  <!-- CARDS WILL COME FROM marketplace.js -->
</div>

<!-- ================= ORIGINAL SCRIPT (UNCHANGED) ================= -->
<script src="js/marketplace.js"></script>

<!-- ================= ORIGINAL INTERNAL SCRIPT (UNCHANGED) ================= -->
<script>
document.getElementById('dark-toggle')
  .addEventListener('click',()=>document.body.classList.toggle('dark'));

const c=document.getElementById('particle-canvas');
const ctx=c.getContext('2d');
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();addEventListener('resize',resize);

const dots=[...Array(90)].map(()=>({
  x:Math.random()*c.width,
  y:Math.random()*c.height,
  r:Math.random()*2+1,
  dx:(Math.random()-.5)*0.6,
  dy:(Math.random()-.5)*0.6
}));

(function animate(){
  ctx.clearRect(0,0,c.width,c.height);
  dots.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle='rgba(255,255,255,.6)';
    ctx.fill();
    p.x+=p.dx; p.y+=p.dy;
    if(p.x<0)p.x=c.width;if(p.y<0)p.y=c.height;
    if(p.x>c.width)p.x=0;if(p.y>c.height)p.y=0;
  });
  requestAnimationFrame(animate);
})();
</script>

<!-- ================= NEW SAFE ANIMATION SCRIPT ================= -->
<script>
/* Skeleton loader for images */
document.addEventListener('DOMContentLoaded',()=>{
  document.querySelectorAll('.item-card img').forEach(img=>{
    const sk=document.createElement('div');
    sk.className='skeleton img';
    img.before(sk);
    img.style.display='none';

    img.onload=()=>{
      sk.remove();
      img.style.display='block';
    };
  });
});

/* Scroll + stagger animation */
const cards=document.querySelectorAll('.item-card');
const obs=new IntersectionObserver(entries=>{
  entries.forEach(entry=>{
    if(entry.isIntersecting){
      const i=[...cards].indexOf(entry.target);
      setTimeout(()=>entry.target.classList.add('show'),i*120);
      obs.unobserve(entry.target);
    }
  });
},{threshold:.2});
cards.forEach(c=>obs.observe(c));

/* 3D tilt (mouse move) */
cards.forEach(card=>{
  card.addEventListener('mousemove',e=>{
    const r=card.getBoundingClientRect();
    const x=e.clientX-r.left;
    const y=e.clientY-r.top;
    const rx=((y/r.height)-0.5)*-10;
    const ry=((x/r.width)-0.5)*10;
    card.style.transform=`rotateX(${rx}deg) rotateY(${ry}deg) scale(1.03)`;
  });
  card.addEventListener('mouseleave',()=>{
    card.style.transform='';
  });
});
</script>

</body>
</html>