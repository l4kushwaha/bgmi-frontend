<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BGMI Market | Home</title>
<link rel="stylesheet" href="styles/index.css">
</head>
<body>

<!-- Floating bubbles -->
<script>
  for(let i=0;i<20;i++){
    const b=document.createElement("div");
    b.className="bubble";
    const s=Math.random()*80+20;
    b.style.width=b.style.height=s+"px";
    b.style.left=Math.random()*100+"vw";
    b.style.top=Math.random()*100+"vh";
    b.style.animationDelay=Math.random()*10+"s";
    document.body.appendChild(b);
  }
</script>

<header>
  <h1>ğŸ® BGMI Market</h1>
  <nav>
    <ul>
      <li><a href="marketplace.html">Marketplace</a></li>
      <li><a href="sell.html">Sell ID</a></li>
      <li><a href="wallet.html">Wallet</a></li>
      <li><a href="profile.html">Profile</a></li>
      <li><a href="popularity.html">Popularity</a></li>
      <li><a href="chat.html">Message</a></li>
      <li id="adminNav" class="hidden"><a href="admin_dashboard.html">Admin Dashboard</a></li>
      <li><a href="#" id="logoutBtn" class="hidden">Logout</a></li>
    </ul>
  </nav>
</header>

<main>

  <!-- Guest View -->
  <section id="guest-view">
    <h2>Welcome to BGMI Market ğŸ¯</h2>
    <p>Please login to access marketplace & dashboard.</p>
    <button onclick="window.location='login.html'">Login</button>
  </section>

  <!-- User / Admin Dashboard -->
  <section id="user-dashboard" class="hidden">
    <h2 id="greeting">Welcome ğŸ‘‹</h2>
    <p>Manage your BGMI journey securely.</p>

    <div class="cards-container" id="cardsContainer">
      <!-- Cards injected via JS -->
    </div>
  </section>

</main>

<footer>
  Â© 2025 BGMI Market | Built with â¤ï¸ by @am_sillent_hunter
</footer>

<script>
function getGreeting(){
  const hour = new Date().getHours();
  if(hour<12) return "Good Morning";
  else if(hour<16) return "Good Afternoon";
  else if(hour<20) return "Good Evening";
  else return "Good Night";
}

function updateDashboard() {
  const token = localStorage.getItem("token");
  const user = JSON.parse(localStorage.getItem("user"));

  const guest = document.getElementById("guest-view");
  const userDash = document.getElementById("user-dashboard");
  const logoutBtn = document.getElementById("logoutBtn");
  const adminNav = document.getElementById("adminNav");
  const greeting = document.getElementById("greeting");
  const cardsContainer = document.getElementById("cardsContainer");

  if(token && user){
    guest.classList.add("hidden");
    userDash.classList.remove("hidden");
    logoutBtn.classList.remove("hidden");

    // clean username
    const username = user.name || user.email?.split('@')[0] || "Player";
    greeting.textContent = `${getGreeting()}, ${username} ğŸ‘‹`;

    // cards
    const cards = [
      {title:"Marketplace", desc:"Buy and sell BGMI IDs.", color:"#48dd84", link:"marketplace.html"},
      {title:"Popularity", desc:"Check player stats & ranking.", color:"#48c4dd", link:"popularity.html"},
      {title:"Profile", desc:"View and edit your profile.", color:"#dd48c4", link:"profile.html"}
    ];

    if(user.role==="admin"){
      adminNav.classList.remove("hidden");
      cards.push({title:"Admin Dashboard", desc:"Manage platform settings.", color:"#ffd700", link:"admin_dashboard.html"});
    }

    // inject cards
    cardsContainer.innerHTML="";
    cards.forEach(card=>{
      const cardEl = document.createElement("div");
      cardEl.className="card-wrapper";
      cardEl.style.color=card.color;
      cardEl.innerHTML=`
        <div class="inner-wrapper">
          <div class="border-layer">
            <div class="card-main"></div>
          </div>
          <div class="card-content">
            <h3>${card.title}</h3>
            <p>${card.desc}</p>
            <button onclick="location.href='${card.link}'">Open</button>
          </div>
        </div>
      `;
      cardsContainer.appendChild(cardEl);
    });

  } else {
    guest.classList.remove("hidden");
    userDash.classList.add("hidden");
    logoutBtn.classList.add("hidden");
    adminNav.classList.add("hidden");
  }
}

updateDashboard();

document.getElementById("logoutBtn").addEventListener("click",()=>{
  localStorage.clear();
  location.reload();
});
</script>

</body>
</html>
